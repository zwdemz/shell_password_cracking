# PHP Webshell POST爆破工具

【文档版本】中文 | [英文版本（README_EN.md）](./README_EN.md)

一款基于Python实现的多线程PHP Webshell POST爆破工具，核心特性为**20线程并发爆破** + **phpinfo()执行结果验证** + **实时进度条** ，解决了传统爆破工具进度条卡住、无法中断的问题。

## 核心功能

- 🚀 多线程并发：最大20线程，自动适配密码数量，支持线程状态监控
- ✅ 精准验证：通过POST执行`phpinfo();`并匹配页面特征，避免误判
- 📊 实时进度：独立进度刷新线程，实时显示爆破进度（百分比/已尝试数）
- 🛡️ 异常处理：支持请求超时、连接异常捕获，避免线程阻塞

## 环境要求

### Python版本

Python 3.7+（推荐3.8-3.11，兼容主流系统）

### 依赖库

仅依赖`requests`和`urllib3`（Python内置库无需额外安装），依赖清单见`requirements.txt`：

```txt

requests>=2.31.0
urllib3>=2.0.7
```

## 安装步骤

1. 克隆/下载本工具到本地，确保目录中包含以下文件：
        `webshell_brute.py`（核心脚本）

2. `requirements.txt`（依赖清单）

3. `README.md`（中文文档，当前文件）

4. `README_EN.md`（英文文档，点击上方链接访问）

5. 安装依赖：
        `pip install -r requirements.txt
# 若权限不足，添加--user参数
pip install --user -r requirements.txt`

## 使用说明

### 1. 准备字典文件

工具默认读取当前目录下的3个字典文件，可自定义路径：

|文件名|作用|格式示例|
|---|---|---|
|`urls.txt`|目标基础URL列表|`http://127.0.0.1:15999/`|
|`shell.txt`|Webshell路径列表|`shell.php`、`dama.php`|
|`pass.txt`|爆破密码字典|`123456`、`admin`、`password`|
|**格式要求**：每行一个条目，自动去重/去空行，编码为UTF-8。|||

### 2. 运行工具

直接执行脚本：

```bash
python webshell_brute.py
```

### 3. 交互流程

1. 脚本启动后，提示输入字典路径（回车使用默认路径）；

2. 加载字典并显示去重后的条目数量；

3. 批量检测目标URL+Shell路径的存活状态；

4. 对存活的PHP Webshell启动多线程爆破；

5. 爆破过程中实时显示进度条，按下`Ctrl+C`可随时中断；

6. 爆破成功时立即输出正确密码、响应状态码等信息。

## 核心配置说明

脚本头部可调整核心参数：

|参数名|默认值|说明|
|---|---|---|
|`TIMEOUT`|3|请求超时时间（秒），缩短可减少线程阻塞|
|`MAX_THREADS`|20|最大并发线程数|
|`PROGRESS_REFRESH_INTERVAL`|0.1|进度条刷新间隔（秒）|
|`RETRY_TIMES`|0|请求重试次数（建议设0，避免阻塞）|
## 输出示例

```bash

===== PHP Webshell 多线程POST爆破工具（支持Ctrl+C退出） =====

核心配置：线程数=20 | 请求超时=3秒

URL列表路径（默认：./urls.txt）：
Shell路径字典（默认：./shell.txt）：
密码字典路径（默认：./pass.txt）：

[加载字典] --------------------------
[字典加载] ./urls.txt → 原始：1 | 去重：1
[字典加载] ./shell.txt → 原始：2 | 去重：2
[字典加载] ./pass.txt → 原始：10002 | 去重：9876

[扫描目标] --------------------------

[检测目标] http://127.0.0.1:15999/
[未存活] http://127.0.0.1:15999/dama.php (HTTP 404)
[存活] http://127.0.0.1:15999/shell.php → 启动爆破

[爆破启动] 目标：http://127.0.0.1:15999/shell.php | 密码数：9876 | 线程数：20
[线程启动] ID:1 → 队列剩余：9876
[线程启动] ID:2 → 队列剩余：9875
...
[爆破进度] |████████████------------------------| 25.0% (2469/9876) | 目标：shell.php

✅ 爆破成功] 线程5 | 密码：123456
[响应] HTTP 200 | 长度：8965 字节

[线程结束] ID:1 → 全局退出标志：False
...
[扫描完成] 所有目标处理完毕
```

## 常见问题

### Q1：进度条卡住不更新？

- 原因：单个请求阻塞/线程挂起；

- 解决：缩短`TIMEOUT`（如改为3秒）、关闭重试（`RETRY_TIMES=0`）。

### Q2：Ctrl+C无法退出？

- 工具已内置信号捕获机制，若仍无法退出，可等待0.5秒（信号处理延迟），或直接关闭终端。

### Q3：爆破成功但实际无法使用？

- 验证逻辑为匹配`phpinfo()`页面特征，若Webshell执行`phpinfo();`被限制，需修改验证规则（调整`PHPINFO_PATTERN`正则）。

## 注意事项

1. **合法使用**：仅可用于授权的渗透测试场景，禁止未经授权的非法攻击；

2. **网络环境**：确保目标网络可达，避免因防火墙/代理导致的连接异常；

3. **性能控制**：根据目标服务器性能调整线程数，避免因并发过高导致目标宕机；

4. **编码兼容**：字典文件建议使用UTF-8编码，避免中文密码乱码。

## 免责声明

本工具仅用于安全研究和授权测试，使用者需遵守《网络安全法》等相关法律法规，因滥用工具导致的一切法律责任由使用者自行承担。

> （注：文档部分内容可能由 AI 生成）